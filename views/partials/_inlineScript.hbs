<script>
    $(function () {
        $('button[type="submit"]').prop('disabled', true)
        $('#configure-instance input[required]').on('keyup change', function () {
            let isDisabled = false
            $('#configure-instance input[required]').each(function () {
                if ($(this).val() == '') {
                    isDisabled = true
                    return false
                }
            })
            $('button[type="submit"]').prop("disabled", isDisabled)
        })
    })

    var submitted = false

    $(function () {
        const sendEventMessage = () => {
            let msg = submitted ? { message: 'submitted' } : { message: 'unloaded' }
            window.opener.postMessage(msg, "*")
        }
        //captures refresh
        window.addEventListener('beforeunload', sendEventMessage)
        //captures submit and window close
        window.addEventListener('unload', sendEventMessage)
    })

</script>