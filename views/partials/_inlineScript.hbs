<script>
    $(function () {
        $('button[type="submit"]').prop('disabled', true)
        $('#configure-instance input[required]').on('keyup change', function () {
            let isDisabled = false
            $('#configure-instance input[required]').each(function () {
                if ($(this).val() == '') {
                    isDisabled = true
                    return false
                }
            })
            $('button[type="submit"]').prop("disabled", isDisabled)
        })
    })

    var submitted = false
    $(function () {
        const sendEventMessage = () => {
            const message = submitted ? 'submitted' : 'unloaded'
            window.opener.postMessage({ message }, "*")
        }
        window.addEventListener('beforeunload', sendEventMessage)
    })
</script>