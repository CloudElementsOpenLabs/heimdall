<script>
    $(function () {
        $('button[type="submit"]').prop('disabled', true)
        $('#configure-instance input[required]').on('keyup change', function () {
            let isDisabled = false
            $('#configure-instance input[required]').each(function () {
                if ($(this).val() == '') {
                    isDisabled = true
                    return false
                }
            })
            $('button[type="submit"]').prop("disabled", isDisabled)
        })
    })

    var submitted = false
    const sendEventMessage = () => {
        //determine if unload fired due to oauth redirects or form submission
        let msg = submitted ? { message: 'submitted' } : { message: 'unloaded' }
        window.opener.postMessage(msg, "*")
    }
    window.addEventListener('unload', sendEventMessage)
</script>